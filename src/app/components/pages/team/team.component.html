<div class="team-page">
    <div class="header">
        <h2 translate>Team</h2>
        <div class="actions">
            <input type="text" placeholder="Search..." [(ngModel)]="filter" />
            <button class="btn btn-primary" (click)="startCreate()">
                <i class="bi bi-plus-lg"></i>
                New Person
            </button>
        </div>
    </div>

    <div class="list" *ngIf="!loading; else loadingTpl">
        <table class="table">
            <thead>
                <tr>
                    <th translate>Full name</th>
                    <th translate>Email</th>
                    <th translate>Phone</th>
                    <th translate>Hourly Rate</th>
                    <th translate>Status</th>
                    <th style="width: 1%"></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let t of filteredTeams; trackBy: trackById"
                    (dblclick)="startEdit(t)">
                    <td>
                        <div class="name">
                            {{ t.nombres }}
                            {{ t.apellidos }}
                        </div>
                    </td>
                    <td>{{ t.correo}}</td>
                    <td>{{ t.celular }}</td>
                    <td>{{ t.valorHora| number:'1.0-0' }}</td>
                    <td>
                        <span class="badge" [class.bg-success]="t.estado"
                            [class.bg-secondary]="!t.estado">
                            {{ t.estado ? 'Activo' : 'Inactivo' }}
                        </span>
                    </td>
                    <td class="text-end nowrap">
                        <button class="btn" title="Editar"
                            (click)="startEdit(t)"><i
                                class="bi bi-pencil"></i></button>
                        <button class="btn" title="Eliminar"
                            (click)="delete(t)"><i
                                class="bi bi-trash"></i></button>
                    </td>
                </tr>
                <tr *ngIf="filteredTeams.length === 0">
                    <td colspan="6" class="text-center muted">No results
                        found</td>
                </tr>
            </tbody>
        </table>
    </div>

    <ng-template #loadingTpl>
        <div class="loading">Loading...</div>
    </ng-template>

    
    <div class="drawer" [class.open]="isFormOpen">
        <div class="drawer-content">
            <div class="drawer-header">
                <h3>{{ isEditing ? 'Edit Person' : 'New Person' }}</h3>
                <button class="btn btn-sm btn-outline-secondary"
                    (click)="cancelForm()">Close</button>
            </div>

            <form [formGroup]="form" (ngSubmit)="submit()" class="form-grid">
                <div class="form-row">
                    <label>First Name *</label>
                    <input formControlName="nombres" type="text"
                        placeholder="First Name" />
                    <small class="error"
                        *ngIf="f['nombres'].touched && f['nombres'].invalid">Required</small>
                </div>

                <div class="form-row">
                    <label>Last Name</label>
                    <input formControlName="apellidos" type="text"
                        placeholder="Last Name" />
                </div>

                <div class="form-row">
                    <label>Email</label>
                    <input formControlName="correo" type="email"
                        placeholder="correo@dominio.com" />
                    <small class="error"
                        *ngIf="f['correo'].touched && f['correo'].invalid">Correo
                        inv√°lido</small>
                </div>

                <div class="form-row">
                    <label>Phone</label>
                    <input formControlName="celular" type="text"
                        placeholder="3001234567" />
                </div>

                <div class="form-row">
                    <label>Hourly Rate</label>
                    <input formControlName="valorHora" type="number" min="0" />
                </div>

                <div class="form-row inline">
                    <label>Status</label>
                    <label class="switch">
                        <input type="checkbox" formControlName="estado" />
                        <span></span>
                    </label>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-light"
                        (click)="cancelForm()">Cancel</button>
                    <button type="submit" class="btn btn-primary"
                        [disabled]="loading">
                        {{ isEditing ? 'Update' : 'Create' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
